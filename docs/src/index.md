```@meta
CurrentModule = WaveProp
```

# WaveProp.jl

*A Julia package for solving some **Boundary Integral Equations**.*

## Overview

This package's purpose is to solve certain PDEs by boundary integral equation methods. Some examples of equations which can be solved using this package are:

| Name | PDE |
|----------------|------------------------------------------------------------------------------------------|
| Laplace | ``-\Delta u = 0`` |
| Helmholtz | ``-\Delta u - k^2u = 0`` |
| Elastostatic | ``-\mu \Delta \vec{u}- (\mu + \lambda) \nabla (\nabla \cdot \vec{u}) = 0`` |
| Elastosdynamic | ``-\mu \Delta \vec{u}- (\mu + \lambda) \nabla (\nabla \cdot \vec{u}) - k^2 \vec{u} = 0`` |

The coefficients $k$,$\lambda$ or $\mu$ are supposed to be piecewise constant;
that is, they can take different values on different domains $\Omega_i$, e.g.
$k(x) = k_i$ for $x \in \Omega_i$, but are not expected to vary continuously.
Both interior and exterior problems can be tackled, and experimental support for
infinite boundaries (i.e. at least one $\Omega_i$ not bounded in some direction)
is also included.

!!! warning
    Support for Maxwell and Stokes equations should be considered experimental

The package contains some basic routines for constructing simple (parametric)
shapes and for meshing them, as well as support for geometries (and meshes)
generated by [Gmsh](https://gmsh.info). See the documentation on the
`WaveProp.IO` module for more information on various input and output formats
supported.

## Installation

Install from the Pkg REPL:

```julia
using Pkg
Pkg.add("https://github.com/WaveProp/WaveProp")
```

## Getting started

Assuming you know your way around boundary integrations...

## Introduction to Nystrom methods

The basic idea of *boundary integral equation* methods is to use a Green
function associated with the PDE, together with the divergence theorem (which
comes under many different names), to recast the PDE as an integral equation. In
the of homogeneous PDE with piece-wise constant coefficients,
this reduces the problem to certain integrals over the boundary where the
between domains where the coefficients change.

!!! tip
    While it is relatively straigh-forward to generalize the methods to
    non-homogenous problems (e.g. Poisson instead of Laplace), tackling PDE with
    continuously varying coefficients using boundary integral equations is much
    more challenging. In fact some of the advantages of using a boundary
    integral formulation vanish in this case, and probably a classical *volume
    discretization* method should be used.

Depending on the boundary condition (e.g. Dirichlet, Neumann), choice of
formulation (e.g. direct, indirect), and choice of Green function (e.g.
freespace, halfspace), a different boundary integral equation must be solved.
Details aside, this quite often comes down to the evaluation of four [`IntegralOperator`](@ref): 

* `SingleLayerOperator`
* `DoubleLayerOperator`
* `AdjointDoubleLayerOperator`
* `HyperSingularOperator`

which form the building block for solving rather complex problems. 

If we take for example Laplace's equation in 2D, then the free-space Green function is given by
```math
G(x,y) = -\frac{\log(||x-y||)}{2\pi},
```
and the single layer operator is
```math
S[\varphi](x) = \int_\Gamma G(x,y)\varphi(y)d\Gamma_y.
```
This package implements a subclass of boundary integral equation methods called *Nystrom*, where such integrals are discretized directly using a quadrature rule, and the value of the unknow function is sought at the quadrature nodes. This leads to approximations of the form
```math
S[\varphi](q_i) \approx \sum_j G(q_i,q_j) \varphi(q_j)w_j,
```
where $(q_j,w_j)$ are a set of quadrature nodes and weights, respectively. Two
well-known difficulties boundary integral equations methods steam from the fact that

1. the kernels become singular as $y \to x$
2. the discretization matrices are dense. 

A large portion of this packages utilities aim at alleviating the first issue, while
issue two is resolved by proving wrappers to appropriate external libraries. 

